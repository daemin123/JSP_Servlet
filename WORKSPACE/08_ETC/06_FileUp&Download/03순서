//--------------------------------------------------------------
//Filter를 이용한  UTF-8  / 알림 아이콘 설정
//--------------------------------------------------------------

//-------------------------------
//[Controller]FrontController
//-------------------------------
- Service 함수내의 utf-8 설정코드 삭제

//-------------------------------
//[Filter] UTF_8_Filter
//-------------------------------
- implements Filter
- doFilter 함수 완성하기 

//-------------------------------
//[Web.xml]
//-------------------------------
- 필터 등록


//-------------------------------
///WEB-INF/view/member/user.jsp 알림아이콘만들기
//-------------------------------
//- google Meterial icon cdn받기
//- 기본 스타일 지정하기
//- font-size:2rem

//-------------------------------
//[Table] tbl_lend_message
//-------------------------------
//msgId(PK) userid,msg
CREATE TABLE `bookdb`.`tbl_lend_message` (
  `msgId` INT NOT NULL AUTO_INCREMENT,
  `userId` VARCHAR(45) NULL,
  `msg` TEXT NULL,
  PRIMARY KEY (`msgId`));
 
 //-------------------------------
 //[Dto] LendMessageDto
 //-------------------------------
-	private int msgId;
-	private String userId;
-	private String msg;
-	toString 재정의
-	getter and Setter
-	기본생성자
-	모든 인자 생성자
	
 //-------------------------------
 //[Dao] LendMessageDaoImpl
 //-------------------------------
 - 코드 확인해보기

 //-------------------------------
 //[Dao] LendMessageDao Interface
 //-------------------------------
 - 코드 확인해보기
 
 //-------------------------------
 //[Service] LendServiceImpl 
 //-------------------------------
 - LendMessageDao 를 등록
 --	private LendMessageDao msgDao;
 -- LendServiceImpl(){}내부코드 확인
 
 - reqLend()함수의 메시지저장코드 추가
 
 //-------------------------------
 //[ConnectionPool] ConnectionPool Conn 공유설정 
 //-------------------------------
- public static Connection conn;
- public static void createConnection() {
		try {
			if(conn==null) {
				Class.forName("com.mysql.cj.jdbc.Driver");
				conn=DriverManager.getConnection(url,id,pw);
				System.out.println("ConnectionPool Connection 생성");
			}
		}catch(Exception e) {
			e.printStackTrace();
		}
	}
 //-------------------------------	
 //[Controller] FrontController 생성자에 코드 추가
 //-------------------------------
 //	ConnectionPool.createConnection();추가
 
 
 //-------------------------------
 //[Service] LendServiceImpl 
 //-------------------------------
 - ConnectionPool.conn.setAutoCommit(false);
 - ConnectionPool.conn.commit();
 - ConnectionPool.conn.setAutoCommit(true);
 //-------------------------------
 //[Controller] LendAddController 
 //-------------------------------
 - Catch부분에 다음코드 추가
 	ConnectionPool.conn.rollback();
 
 //
 //-------------------------------
 //	[Filter] UserLendMessageFilter 
 //-------------------------------
 // 코드 확인하기
 
 //-------------------------------
 //	[web.xml] UserLendMessageFilter등록 
 //-------------------------------
 // 코드 확인하기
 
 //-------------------------------
 //	[View] /WEB-INF/view/member/user.jsp
 //-------------------------------
 // Session에 저장된 alarm_cnt,alarm_list로
 // 알림메시지 처리하기
 
 // 메시지를 확인하고 나면 tbl_lend_message에
 // 내용삭제 비동기요청 처리하기
 
 //-------------------------------
 //	[Controller] FrontController
 //-------------------------------
 - /lend/messageRemove.do 등록하기

//-------------------------------
//	[Controller] LendMessageRemoveController
//-------------------------------
- 코드 확인
//-------------------------------
//[service] Controller Interface
//-------------------------------
- void removeMessage(HttpServletRequest req);



//-----------------------------------------------------
//Listener 로 접속현황 파악하기(with Chart.js)
//--------------------------------------------------------------
//-------------------------------
//[DB] tbl_member에 admin 등록
//-------------------------------
admin	1234	admin	ROLE_ADMIN
등록

//-------------------------------
// [table] tbl_log
//-------------------------------
//id(PK),total,user,member,date

CREATE TABLE `bookdb`.`tbl_log` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `total` INT NULL,
  `user` INT NULL,
  `member` INT NULL,
  `date` DATE NULL,
  PRIMARY KEY (`id`));


//-------------------------------
// [Dto] LogDto
//-------------------------------
// 코드 확인


//-------------------------------
// [Dao] LogDaoImpl
//-------------------------------
// 코드 확인

//-------------------------------
// [Dao] LogDao Interface
//-------------------------------
// 코드 확인

//-------------------------------
// [Service] LogServiceImpl
//-------------------------------
// 코드 확인

//-------------------------------
// [Service] LogService Interface
//-------------------------------
// 코드 확인





//-------------------------------
///WEB-INF/view/admin/admin.jsp 생성
//-------------------------------
- 기본 스타일 코드 추가
- chart.js cdn 가져오기
- Application이 동작하는동안 들어오는 총접속량별 위치 지정
- Application이 동작하는동안 들어오는 유저 접속량별 위치 지정
- Application이 동작하는동안 들어오는 사서 접속량별 위치 지정




//-------------------------------
//[Controller] MemberPageController 에 코드 추가
//-------------------------------
- else if(role.equals("ROLE_ADMIN")) {
req.getRequestDispatcher("/WEB-INF/view/admin/admin.jsp").forward(req, resp);
}



//-------------------------------
// [log] State 클래스 추가
//-------------------------------
//- Listener>log>State.java 추가












//
//-------------------------------
// [Listener] InitServletContextListener
//-------------------------------
- private LogService logService = LogServiceImpl.getInstance();

- implements ServletContextListener
- contextInitialized 함수 재정의
- FrontController로 부터 ConnectionPool.createConnection(); 가져와서 처리
-- 서블릿 동작시 Connection 객체 바로 생성 

- logService.addLog();호출
  



//-------------------------------
// Session 생성에 따른 속성 추가 / 변경
//-------------------------------
// 총 접속량(비회원 + 로그인회원)
// 유저 총 접속량(ROLE_USER만 Conunt)
// 사서 총 접속량(ROLE_MEMBER만 Count)

// 



//-------------------------------
// Session 접속시 리스너 
//-------------------------------





//--------------------------------------------------------------
//Paging 처리위한 코드 추가
//--------------------------------------------------------------
//-------------------------------
//
//-------------------------------


//--------------------------------------------------------------
//비동기요청 종류
//--------------------------------------------------------------

// 외부 API
// Daum주소검색API
// 카카오맵 / 카카오로그인 / 카카오메시지
// 네이버검색 / 네이버메일 / 네이버플랫폼 SMS전달 / 네이버로그인
// Google Oauth / 구글메일
// etc..

